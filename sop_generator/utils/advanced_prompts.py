from typing import Dict, List, Any, Optional
from dataclasses import dataclass
from enum import Enum
import re
import json


class SectionType(Enum):
    PURPOSE_SCOPE = "purpose_scope"
    RESPONSIBILITY = "responsibility"
    SAFETY_RISK = "safety_risk"  
    EQUIPMENT_MATERIALS = "equipment_materials"
    PROCEDURES = "procedures"
    QUALITY_CONTROL = "quality_control"
    DOCUMENTATION = "documentation"
    REFERENCES = "references"
    TROUBLESHOOTING = "troubleshooting"


class EquipmentCategory(Enum):
    CHROMATOGRAPHY = "chromatography"
    SPECTROSCOPY = "spectroscopy"
    MICROSCOPY = "microscopy"
    ANALYTICAL_BALANCE = "analytical_balance"
    CENTRIFUGE = "centrifuge"
    THERMAL_ANALYZER = "thermal_analyzer"
    GENERIC = "generic"


@dataclass
class PromptTemplate:
    """Professional prompt template with context-aware generation"""
    section_type: SectionType
    equipment_category: EquipmentCategory
    base_prompt: str
    technical_requirements: List[str]
    safety_requirements: List[str]
    regulatory_requirements: List[str]
    quality_criteria: List[str]
    examples: List[str] = None
    
    def __post_init__(self):
        if self.examples is None:
            self.examples = []


class AdvancedPromptEngine:
    """Advanced content generation prompt system for professional SOP creation"""
    
    def __init__(self):
        self.prompt_templates = self._initialize_prompt_templates()
        self.context_enhancers = self._initialize_context_enhancers()
        self.validation_criteria = self._initialize_validation_criteria()
    
    def _initialize_prompt_templates(self) -> Dict[SectionType, Dict[EquipmentCategory, PromptTemplate]]:
        """Initialize comprehensive prompt templates for each section type and equipment category"""
        
        templates = {}
        
        # PURPOSE AND SCOPE SECTION
        templates[SectionType.PURPOSE_SCOPE] = {
            EquipmentCategory.CHROMATOGRAPHY: PromptTemplate(
                section_type=SectionType.PURPOSE_SCOPE,
                equipment_category=EquipmentCategory.CHROMATOGRAPHY,
                base_prompt="""
–°–æ–∑–¥–∞–π —Ä–∞–∑–¥–µ–ª "–¶–µ–ª—å –∏ –æ–±–ª–∞—Å—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è" –¥–ª—è —Ö—Ä–æ–º–∞—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π –ø—Ä–æ—Ü–µ–¥—É—Ä—ã —Å —É–∫–∞–∑–∞–Ω–∏–µ–º:

–ö–û–ù–ö–†–ï–¢–ù–´–ï –¶–ï–õ–ò –ü–†–û–¶–ï–î–£–†–´:
- –¢–æ—á–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞–Ω–∞–ª–∏—Ç–æ–≤ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–π
- –¢–∏–ø—ã –æ–±—Ä–∞–∑—Ü–æ–≤ –∏ –º–∞—Ç—Ä–∏—Ü (–ø–ª–∞–∑–º–∞, –º–æ—á–∞, –ø–æ—á–≤–∞, –ø–∏—â–µ–≤—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã –∏ —Ç.–¥.)
- –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –æ–±—Ä–∞–∑—Ü–æ–≤
- –û–∂–∏–¥–∞–µ–º—ã–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ (LOD, LOQ, –ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å)

–û–ë–õ–ê–°–¢–¨ –ü–†–ò–ú–ï–ù–ï–ù–ò–Ø:
- –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –æ—Ç—Ä–∞—Å–ª–∏ –∏ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏
- –†–µ–≥—É–ª–∏—Ä—É–µ–º—ã–µ –æ–±–ª–∞—Å—Ç–∏ (—Ñ–∞—Ä–º–∞—Ü–µ–≤—Ç–∏–∫–∞, –ø–∏—â–µ–≤–∞—è, —ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è)
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º (USP, EP, FDA)

–û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø –ò –ò–°–ö–õ–Æ–ß–ï–ù–ò–Ø:
- –ù–µ–ø—Ä–∏–º–µ–Ω–∏–º—ã–µ —Ç–∏–ø—ã –æ–±—Ä–∞–∑—Ü–æ–≤
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è–º
- –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –º–∞—Ç—Ä–∏—Ü—ã
- –ò—Å–∫–ª—é—á–µ–Ω–∏—è –ø–æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ, pH, —Ä–∞—Å—Ç–≤–æ—Ä–∏—Ç–µ–ª—è–º
""",
                technical_requirements=[
                    "–£–∫–∞–∂–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–Ω–∞–ª–∏—Ç–∞",
                    "–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –æ–±—Ä–∞–∑—Ü–æ–≤",
                    "–£–∫–∞–∂–∏—Ç–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–ª–µ–º–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã –ø—Ä–∏–≥–æ–¥–Ω–æ—Å—Ç–∏",
                    "–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –º–µ—Ç–æ–¥–∏–∫–∏"
                ],
                safety_requirements=[
                    "–£–∫–∞–∂–∏—Ç–µ –æ–ø–∞—Å–Ω—ã–µ —Ä–∞—Å—Ç–≤–æ—Ä–∏—Ç–µ–ª–∏ –∏ –∏—Ö –∫–ª–∞—Å—Å—ã",
                    "–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –≤—ã—Ç—è–∂–Ω–æ–π –≤–µ–Ω—Ç–∏–ª—è—Ü–∏–∏",
                    "–£–∫–∞–∂–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –°–ò–ó –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –º–æ–±–∏–ª—å–Ω—ã–º–∏ —Ñ–∞–∑–∞–º–∏",
                    "–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —É—Ç–∏–ª–∏–∑–∞—Ü–∏–∏ –æ—Ç—Ö–æ–¥–æ–≤"
                ],
                regulatory_requirements=[
                    "–°—Å—ã–ª–∫–∞ –Ω–∞ ICH Q2(R1) –≤–∞–ª–∏–¥–∞—Ü–∏—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Ç–æ–¥–∏–∫",
                    "–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º GMP/GLP",
                    "–°–æ–±–ª—é–¥–µ–Ω–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–º –∑–∞–ø–∏—Å—è–º (21 CFR Part 11)"
                ],
                quality_criteria=[
                    "–û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏",
                    "–£–∫–∞–∑–∞–Ω—ã —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π",
                    "–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –ø—Ä–æ—Å–ª–µ–∂–∏–≤–∞–µ–º–æ—Å—Ç—å –∫ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º"
                ]
            ),
            
            EquipmentCategory.SPECTROSCOPY: PromptTemplate(
                section_type=SectionType.PURPOSE_SCOPE,
                equipment_category=EquipmentCategory.SPECTROSCOPY,
                base_prompt="""
–°–æ–∑–¥–∞–π —Ä–∞–∑–¥–µ–ª "–¶–µ–ª—å –∏ –æ–±–ª–∞—Å—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è" –¥–ª—è —Å–ø–µ–∫—Ç—Ä–æ—Å–∫–æ–ø–∏—á–µ—Å–∫–æ–π –ø—Ä–æ—Ü–µ–¥—É—Ä—ã —Å —É–∫–∞–∑–∞–Ω–∏–µ–º:

–ê–ù–ê–õ–ò–¢–ò–ß–ï–°–ö–ò–ï –¶–ï–õ–ò:
- –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –∏/–∏–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –°–ø–µ–∫—Ç—Ä–∞–ª—å–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–ª–æ—Å—ã –ø–æ–≥–ª–æ—â–µ–Ω–∏—è
- –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—é –∏ —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π
- –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –æ–±—Ä–∞–∑—Ü–æ–≤

–û–ë–õ–ê–°–¢–¨ –ü–†–ò–ú–ï–ù–ï–ù–ò–Ø:
- –¢–∏–ø—ã –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã—Ö –≤–µ—â–µ—Å—Ç–≤ (–æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏–µ, –Ω–µ–æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏–µ)
- –§–∏–∑–∏—á–µ—Å–∫–∏–µ —Ñ–æ—Ä–º—ã –æ–±—Ä–∞–∑—Ü–æ–≤ (—Ä–∞—Å—Ç–≤–æ—Ä—ã, —Ç–≤–µ—Ä–¥—ã–µ —Ç–µ–ª–∞, –≥–∞–∑—ã)
- –û—Ç—Ä–∞—Å–ª–µ–≤—ã–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è (—Ñ–∞—Ä–º–∞—Ü–µ–≤—Ç–∏–∫–∞, –Ω–µ—Ñ—Ç–µ—Ö–∏–º–∏—è, –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤–µ–¥–µ–Ω–∏–µ)
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º (ASTM, ISO)

–û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø –ò –ò–°–ö–õ–Æ–ß–ï–ù–ò–Ø:
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –æ–ø—Ç–∏—á–µ—Å–∫–æ–π –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏
- –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ —Ä–∞—Å—Ç–≤–æ—Ä–∏—Ç–µ–ª–∏
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —Ä–∞–∑–º–µ—Ä—É —á–∞—Å—Ç–∏—Ü
- –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏–∑–º–µ—Ä–µ–Ω–∏–π
""",
                technical_requirements=[
                    "–£–∫–∞–∂–∏—Ç–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã –¥–ª–∏–Ω –≤–æ–ª–Ω –∏ —Å–ø–µ–∫—Ç—Ä–∞–ª—å–Ω–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ",
                    "–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∏–∑–ª—É—á–µ–Ω–∏—è",
                    "–£–∫–∞–∂–∏—Ç–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –≤—ã–±–æ—Ä–∞ –∫—é–≤–µ—Ç –∏ –¥–µ—Ä–∂–∞—Ç–µ–ª–µ–π –æ–±—Ä–∞–∑—Ü–æ–≤",
                    "–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –∫–æ–Ω—Ç—Ä–æ–ª—è —Å—Ç—Ä–µ–π-—Å–≤–µ—Ç–∞"
                ],
                safety_requirements=[
                    "–£–∫–∞–∂–∏—Ç–µ –º–µ—Ä—ã –∑–∞—â–∏—Ç—ã –æ—Ç –£–§ –∏ –ò–ö –∏–∑–ª—É—á–µ–Ω–∏—è",
                    "–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–∞–±–æ—Ç–µ —Å —Ç–æ–∫—Å–∏—á–Ω—ã–º–∏ —Ä–∞—Å—Ç–≤–æ—Ä–∏—Ç–µ–ª—è–º–∏",
                    "–£–∫–∞–∂–∏—Ç–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –ª–∞–∑–µ—Ä–Ω—ã–º–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏"
                ],
                regulatory_requirements=[
                    "–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ USP <857> –£–§-–≤–∏–¥–∏–º–∞—è —Å–ø–µ–∫—Ç—Ä–æ—Å–∫–æ–ø–∏—è",
                    "–°–æ–±–ª—é–¥–µ–Ω–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π ISO 17025",
                    "–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ì–û–°–¢ 8.207-76 –¥–ª—è —Ñ–æ—Ç–æ–º–µ—Ç—Ä–æ–≤"
                ],
                quality_criteria=[
                    "–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å –∏ –ø–æ–≤—Ç–æ—Ä—è–µ–º–æ—Å—Ç—å",
                    "–£–∫–∞–∑–∞–Ω—ã –∫—Ä–∏—Ç–µ—Ä–∏–∏ –ª–∏–Ω–µ–π–Ω–æ—Å—Ç–∏ –¥–µ—Ç–µ–∫—Ç–æ—Ä–æ–≤",
                    "–û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–∞–ª–∏–±—Ä–æ–≤–∫–µ –¥–ª–∏–Ω –≤–æ–ª–Ω"
                ]
            ),
            
            # Add generic template for other equipment types
            EquipmentCategory.GENERIC: PromptTemplate(
                section_type=SectionType.PURPOSE_SCOPE,
                equipment_category=EquipmentCategory.GENERIC,
                base_prompt="""
–°–æ–∑–¥–∞–π —Ä–∞–∑–¥–µ–ª "–¶–µ–ª—å –∏ –æ–±–ª–∞—Å—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è" —Å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π:

–ö–û–ù–ö–†–ï–¢–ù–´–ï –¶–ï–õ–ò:
- –ß–µ—Ç–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–∑–º–µ—Ä—è–µ–º—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –î–∏–∞–ø–∞–∑–æ–Ω—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π –∏ —Ç—Ä–µ–±—É–µ–º–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å
- –¢–∏–ø—ã –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
- –û–∂–∏–¥–∞–µ–º—ã–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

–û–ë–õ–ê–°–¢–¨ –ü–†–ò–ú–ï–ù–ï–ù–ò–Ø:
- –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –æ–±–ª–∞—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –ü—Ä–∏–º–µ–Ω–∏–º—ã–µ –æ—Ç—Ä–∞—Å–ª–∏ –∏ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –∏ –Ω–æ—Ä–º–∞—Ç–∏–≤–∞–º
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

–û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø –ò –ò–°–ö–õ–Æ–ß–ï–ù–ò–Ø:
- –ß–µ—Ç–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Å–ª—É—á–∞–∏ –Ω–µ–ø—Ä–∏–º–µ–Ω–∏–º–æ—Å—Ç–∏
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —É—Å–ª–æ–≤–∏—è–º —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏
- –ò—Å–∫–ª—é—á–µ–Ω–∏—è –ø–æ —Ç–∏–ø–∞–º –æ–±—Ä–∞–∑—Ü–æ–≤ –∏–ª–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
- –û—Å–æ–±—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø–µ—Ä—Å–æ–Ω–∞–ª—É
""",
                technical_requirements=[
                    "–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –∏–∑–º–µ—Ä—è–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –∏—Ö –¥–∏–∞–ø–∞–∑–æ–Ω—ã",
                    "–£–∫–∞–∂–∏—Ç–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏",
                    "–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–ª–µ–º–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤"
                ],
                safety_requirements=[
                    "–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã",
                    "–£–∫–∞–∂–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏",
                    "–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –°–ò–ó"
                ],
                regulatory_requirements=[
                    "–£–∫–∞–∂–∏—Ç–µ –ø—Ä–∏–º–µ–Ω–∏–º—ã–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã –∏ –Ω–æ—Ä–º–∞—Ç–∏–≤—ã",
                    "–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—é"
                ],
                quality_criteria=[
                    "–û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∫—Ä–∏—Ç–µ—Ä–∏–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã",
                    "–£–∫–∞–∑–∞–Ω—ã —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏"
                ]
            )
        }
        
        # SAFETY AND RISK ASSESSMENT SECTION
        templates[SectionType.SAFETY_RISK] = {
            EquipmentCategory.CHROMATOGRAPHY: PromptTemplate(
                section_type=SectionType.SAFETY_RISK,
                equipment_category=EquipmentCategory.CHROMATOGRAPHY,
                base_prompt="""
–°–æ–∑–¥–∞–π –¥–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª "–ê–Ω–∞–ª–∏–∑ —Ä–∏—Å–∫–æ–≤ –∏ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏" –¥–ª—è —Ö—Ä–æ–º–∞—Ç–æ–≥—Ä–∞—Ñ–∏–∏:

–ò–î–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø –û–ü–ê–°–ù–û–°–¢–ï–ô:
1. **–•–∏–º–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏:**
   - –¢–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å –º–æ–±–∏–ª—å–Ω—ã—Ö —Ñ–∞–∑ (–∞—Ü–µ—Ç–æ–Ω–∏—Ç—Ä–∏–ª –∫–ª–∞—Å—Å 1B, –º–µ—Ç–∞–Ω–æ–ª –∫–ª–∞—Å—Å 1B)
   - –ö–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ –±—É—Ñ–µ—Ä–æ–≤ (—Ç—Ä–∏—Ñ—Ç–æ—Ä—É–∫—Å—É—Å–Ω–∞—è –∫–∏—Å–ª–æ—Ç–∞)
   - –ö–∞–Ω—Ü–µ—Ä–æ–≥–µ–Ω–Ω—ã–µ —Ä–∞—Å—Ç–≤–æ—Ä–∏—Ç–µ–ª–∏ (–î–ú–°–û, –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –≥–∞–ª–æ–≥–µ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ)
   - –†–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

2. **–§–∏–∑–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏:**
   - –í—ã—Å–æ–∫–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã (–¥–æ 600 –±–∞—Ä) - —Ä–∏—Å–∫ —Ä–∞–∑—Ä—ã–≤–∞ —Ñ–∏—Ç–∏–Ω–≥–æ–≤
   - –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã–µ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª–∏ –∫–æ–ª–æ–Ω–æ–∫ –¥–æ 80¬∞C)
   - –û—Å—Ç—Ä—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã (–∏–≥–ª—ã –∏–Ω–∂–µ–∫—Ç–æ—Ä–æ–≤, –æ—Å–∫–æ–ª–∫–∏ —Å—Ç–µ–∫–ª—è–Ω–Ω–æ–π –ø–æ—Å—É–¥—ã)
   - –≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–µ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–≤—ã—Å–æ–∫–æ–≤–æ–ª—å—Ç–Ω—ã–µ –¥–µ—Ç–µ–∫—Ç–æ—Ä—ã)

3. **–≠—Ä–≥–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã:**
   - –ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –¥–≤–∏–∂–µ–Ω–∏—è –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –æ–±—Ä–∞–∑—Ü–æ–≤
   - –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ—Å–∞–¥–∫–∞ –ø—Ä–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ
   - –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –∑—Ä–µ–Ω–∏–µ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –º–µ–ª–∫–∏–º–∏ –¥–µ—Ç–∞–ª—è–º–∏

–û–¶–ï–ù–ö–ê –†–ò–°–ö–û–í (–º–∞—Ç—Ä–∏—Ü–∞ 5√ó5):
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏ (–†√ó–¢ ‚â• 15): –†–∞–∑—Ä—ã–≤ –ø–æ–¥ –¥–∞–≤–ª–µ–Ω–∏–µ–º, –æ—Ç—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–∏
- –í—ã—Å–æ–∫–∏–µ —Ä–∏—Å–∫–∏ (–†√ó–¢ = 9-12): –•–∏–º–∏—á–µ—Å–∫–∏–µ –æ–∂–æ–≥–∏, –ø–æ—Ä–∞–∂–µ–Ω–∏–µ —ç–ª–µ–∫—Ç—Ä–æ—Ç–æ–∫–æ–º  
- –°—Ä–µ–¥–Ω–∏–µ —Ä–∏—Å–∫–∏ (–†√ó–¢ = 4-8): –ü–æ—Ä–µ–∑—ã, —Ä–∞–∑–¥—Ä–∞–∂–µ–Ω–∏–µ –∫–æ–∂–∏

–ú–ï–†–´ –ö–û–ù–¢–†–û–õ–Ø (–∏–µ—Ä–∞—Ä—Ö–∏—è):
1. –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: –ó–∞–º–µ–Ω–∞ —Ç–æ–∫—Å–∏—á–Ω—ã—Ö —Ä–∞—Å—Ç–≤–æ—Ä–∏—Ç–µ–ª–µ–π –±–µ–∑–æ–ø–∞—Å–Ω—ã–º–∏ –∞–Ω–∞–ª–æ–≥–∞–º–∏
2. –ò–Ω–∂–µ–Ω–µ—Ä–Ω—ã–µ –º–µ—Ä—ã: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–∏—Å—Ç–µ–º—ã —Å–±—Ä–æ—Å–∞ –¥–∞–≤–ª–µ–Ω–∏—è
3. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ: –û–±—É—á–µ–Ω–∏–µ, –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –õ–û–¢–û
4. –°–ò–ó: –ù–∏—Ç—Ä–∏–ª–æ–≤—ã–µ –ø–µ—Ä—á–∞—Ç–∫–∏, –∑–∞—â–∏—Ç–Ω—ã–µ –æ—á–∫–∏, —Ö–∞–ª–∞—Ç—ã
""",
                technical_requirements=[
                    "–£–∫–∞–∂–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–∞–≤–ª–µ–Ω–∏—è –∏ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã",
                    "–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–æ—á–∫–∏ –∫–æ–Ω—Ç—Ä–æ–ª—è",
                    "–£–∫–∞–∂–∏—Ç–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –∞–≤–∞—Ä–∏–π–Ω–æ–≥–æ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è",
                    "–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–∏—Å—Ç–µ–º–∞–º –ø—Ä–µ–¥–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è"
                ],
                safety_requirements=[
                    "–î–µ—Ç–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –≤—ã—Ç—è–∂–Ω–æ–π –≤–µ–Ω—Ç–∏–ª—è—Ü–∏–∏",
                    "–£–∫–∞–∂–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –°–ò–ó –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ —Ä–∞–±–æ—Ç",
                    "–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –¥–µ–∫–æ–Ω—Ç–∞–º–∏–Ω–∞—Ü–∏–∏",
                    "–£–∫–∞–∂–∏—Ç–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ö—Ä–∞–Ω–µ–Ω–∏—é —Ö–∏–º–∏–∫–∞—Ç–æ–≤"
                ],
                regulatory_requirements=[
                    "–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ì–û–°–¢ 12.1.005-88 (–≤–æ–∑–¥—É—Ö —Ä–∞–±–æ—á–µ–π –∑–æ–Ω—ã)",
                    "–°–æ–±–ª—é–¥–µ–Ω–∏–µ –°–∞–Ω–ü–∏–ù 1.2.3685-21 (–≥–∏–≥–∏–µ–Ω–∏—á–µ—Å–∫–∏–µ –Ω–æ—Ä–º–∞—Ç–∏–≤—ã)",
                    "–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º OSHA 1910.1200 (HazCom)",
                    "–°–æ–±–ª—é–¥–µ–Ω–∏–µ ISO 45001:2018 (—Å–∏—Å—Ç–µ–º–∞ –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç–∞ –û–¢)"
                ],
                quality_criteria=[
                    "–ü—Ä–æ–≤–µ–¥–µ–Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–æ–≤",
                    "–û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –º–µ—Ä—ã –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∏—Å–∫–∞",
                    "–£–∫–∞–∑–∞–Ω—ã –∫—Ä–∏—Ç–µ—Ä–∏–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –º–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"
                ]
            ),
            
            # Add generic safety template
            EquipmentCategory.GENERIC: PromptTemplate(
                section_type=SectionType.SAFETY_RISK,
                equipment_category=EquipmentCategory.GENERIC,
                base_prompt="""
–°–æ–∑–¥–∞–π –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Ä–∞–∑–¥–µ–ª "–ê–Ω–∞–ª–∏–∑ —Ä–∏—Å–∫–æ–≤ –∏ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏":

–°–ò–°–¢–ï–ú–ê–¢–ò–ß–ï–°–ö–ê–Ø –ò–î–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–Ø –û–ü–ê–°–ù–û–°–¢–ï–ô:
1. –§–∏–∑–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏ (–º–µ—Ö–∞–Ω–∏—á–µ—Å–∫–∏–µ, —Ç–µ—Ä–º–∏—á–µ—Å–∫–∏–µ, —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–µ)
2. –•–∏–º–∏—á–µ—Å–∫–∏–µ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (—Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å, –∫–æ—Ä—Ä–æ–∑–∏—è, —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å)
3. –ë–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏ (–∏–Ω—Ñ–µ–∫—Ü–∏–∏, –∞–ª–ª–µ—Ä–≥–µ–Ω—ã)
4. –≠—Ä–≥–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã (–Ω–∞–≥—Ä—É–∑–∫–∏, –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –¥–≤–∏–∂–µ–Ω–∏—è)
5. –≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –∞—Å–ø–µ–∫—Ç—ã (–≤—ã–±—Ä–æ—Å—ã, –æ—Ç—Ö–æ–¥—ã)

–ö–û–õ–ò–ß–ï–°–¢–í–ï–ù–ù–ê–Ø –û–¶–ï–ù–ö–ê –†–ò–°–ö–û–í:
- –ú–∞—Ç—Ä–∏—Ü–∞ "–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å √ó —Ç—è–∂–µ—Å—Ç—å –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π"
- –ß–∏—Å–ª–æ–≤—ã–µ —Ä–µ–π—Ç–∏–Ω–≥–∏ —Ä–∏—Å–∫–æ–≤
- –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è –º–µ—Ä –∫–æ–Ω—Ç—Ä–æ–ª—è

–ò–ï–†–ê–†–•–ò–Ø –ú–ï–† –ö–û–ù–¢–†–û–õ–Ø:
1. –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –æ–ø–∞—Å–Ω–æ—Å—Ç–∏
2. –ó–∞–º–µ–Ω–∞ –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã
3. –ò–Ω–∂–µ–Ω–µ—Ä–Ω—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –∑–∞—â–∏—Ç—ã
4. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ä—ã
5. –°—Ä–µ–¥—Å—Ç–≤–∞ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–π –∑–∞—â–∏—Ç—ã

–ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –í –ü–†–û–¶–ï–î–£–†–´:
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–æ—á–∫–∞—Ö
- –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–µ –ª–∏—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ü—Ä–æ—Ü–µ–¥—É—Ä—ã —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã
""",
                technical_requirements=[
                    "–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏",
                    "–£–∫–∞–∂–∏—Ç–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–Ω—Ç—Ä–æ–ª—è",
                    "–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Å–∏—Å—Ç–µ–º—ã —Å–∏–≥–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫"
                ],
                safety_requirements=[
                    "–î–µ—Ç–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –°–ò–ó",
                    "–£–∫–∞–∂–∏—Ç–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Ä–∞–±–æ—Ç—ã",
                    "–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –∞–≤–∞—Ä–∏–π–Ω—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã"
                ],
                regulatory_requirements=[
                    "–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø—Ä–∏–º–µ–Ω–∏–º—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏",
                    "–°–æ–±–ª—é–¥–µ–Ω–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –æ—Ö—Ä–∞–Ω—ã —Ç—Ä—É–¥–∞",
                    "–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —ç–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–º –Ω–æ—Ä–º–∞–º"
                ],
                quality_criteria=[
                    "–ü—Ä–æ–≤–µ–¥–µ–Ω —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Ä–∏—Å–∫–æ–≤",
                    "–û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –º–µ—Ä—ã –∫–æ–Ω—Ç—Ä–æ–ª—è",
                    "–£–∫–∞–∑–∞–Ω—ã –∫—Ä–∏—Ç–µ—Ä–∏–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"
                ]
            )
        }
        
        # PROCEDURES SECTION
        templates[SectionType.PROCEDURES] = {
            EquipmentCategory.CHROMATOGRAPHY: PromptTemplate(
                section_type=SectionType.PROCEDURES,
                equipment_category=EquipmentCategory.CHROMATOGRAPHY,
                base_prompt="""
–°–æ–∑–¥–∞–π –¥–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª "–ü–æ—à–∞–≥–æ–≤—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã" –¥–ª—è —Ö—Ä–æ–º–∞—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞:

I. –ü–û–î–ì–û–¢–û–í–ö–ê –°–ò–°–¢–ï–ú–´
1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è (5-10 –º–∏–Ω)**
   - –í–∏–∑—É–∞–ª—å–Ω–∞—è –∏–Ω—Å–ø–µ–∫—Ü–∏—è: –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ—Ç–µ—á–µ–∫, –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π ‚úì
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–≤–ª–µ–Ω–∏—è –≤ –ø–æ–∫–æ–µ: ‚â§ 5 –±–∞—Ä ‚úì
   - –°–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–ª–æ–Ω–∫–∏: –¥–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞—Ç–Ω–æ–π –ø—Ä–æ–º—ã–≤–∫–∏ < 50 –±–∞—Ä ‚úì
   - **–ö—Ä–∏—Ç–µ—Ä–∏–π –ø—Ä–∏–µ–º–∫–∏**: –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã, —Å–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ
   - **–ü—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–∏**: –°–º. —Ä–∞–∑–¥–µ–ª "–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π"

2. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–æ–±–∏–ª—å–Ω–æ–π —Ñ–∞–∑—ã (15-20 –º–∏–Ω)**
   - –í–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ –±—É—Ñ–µ—Ä–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤: —Ç–æ—á–Ω–æ—Å—Ç—å ¬±0.1 –º–≥ ‚úì
   - –†–∞—Å—Ç–≤–æ—Ä–µ–Ω–∏–µ –≤ –¥–µ–∏–æ–Ω–∏–∑–æ–≤–∞–Ω–Ω–æ–π –≤–æ–¥–µ (—É–¥–µ–ª—å–Ω–æ–µ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ ‚â• 18.2 –ú–û–º¬∑—Å–º) ‚úì
   - –î–æ–≤–µ–¥–µ–Ω–∏–µ pH –¥–æ 3.0 ¬± 0.1 (pH-–º–µ—Ç—Ä –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ –≤ –¥–µ–Ω—å –∏–∑–º–µ—Ä–µ–Ω–∏—è) ‚úì
   - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –º–µ–º–±—Ä–∞–Ω—É 0.22 –º–∫–º ‚úì
   - –î–µ–≥–∞–∑–∞—Ü–∏—è –≤ —É–ª—å—Ç—Ä–∞–∑–≤—É–∫–æ–≤–æ–π –±–∞–Ω–µ 10 ¬± 2 –º–∏–Ω ‚úì
   - **–ö—Ä–∏—Ç–µ—Ä–∏–π –ø—Ä–∏–µ–º–∫–∏**: pH –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—É–∑—ã—Ä—å–∫–æ–≤
   - **–í–ù–ò–ú–ê–ù–ò–ï**: –†–∞–±–æ—Ç–∞ —Å –∫–∏—Å–ª–æ—Ç–∞–º–∏ - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –∑–∞—â–∏—Ç–Ω—ã–µ –æ—á–∫–∏ –∏ –Ω–∏—Ç—Ä–∏–ª–æ–≤—ã–µ –ø–µ—Ä—á–∞—Ç–∫–∏

3. **–ü—Ä–æ–º—ã–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∏ —É—Ä–∞–≤–Ω–æ–≤–µ—à–∏–≤–∞–Ω–∏–µ (20-30 –º–∏–Ω)**
   - –°–∫–æ—Ä–æ—Å—Ç—å –ø–æ—Ç–æ–∫–∞: 1.0 –º–ª/–º–∏–Ω ¬± 2% ‚úì
   - –°–æ—Å—Ç–∞–≤: 100% –±—É—Ñ–µ—Ä –ê ‚úì
   - –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: –¥–æ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ –±–∞–∑–æ–≤–æ–π –ª–∏–Ω–∏–∏ ‚úì
   - –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–∞–≤–ª–µ–Ω–∏—è: –¥–æ–ª–∂–Ω–æ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 150-200 –±–∞—Ä ‚úì
   - **–ö—Ä–∏—Ç–µ—Ä–∏–π –ø—Ä–∏–µ–º–∫–∏**: –î—Ä–µ–π—Ñ –±–∞–∑–æ–≤–æ–π –ª–∏–Ω–∏–∏ < 1 –ºAU/—á–∞—Å
   - **–ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–∏**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞—Å–æ—Ä–µ–Ω–∏–µ —Ñ—Ä–∏—Ç–æ–≤ –∫–æ–ª–æ–Ω–∫–∏

II. –ê–ù–ê–õ–ò–ó –û–ë–†–ê–ó–¶–û–í
4. **–ò–Ω—ä–µ–∫—Ü–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ä–∞—Å—Ç–≤–æ—Ä–æ–≤**
   - –û–±—ä–µ–º –∏–Ω—ä–µ–∫—Ü–∏–∏: 10 ¬± 0.1 –º–∫–ª ‚úì
   - –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å: –±–ª–∞–Ω–∫ ‚Üí —Ö–æ–ª–æ—Å—Ç–∞—è ‚Üí —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é ‚úì
   - –ò–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –∏–Ω—ä–µ–∫—Ü–∏—è–º–∏: 15 ¬± 2 –º–∏–Ω ‚úì
   - **–ö–æ–Ω—Ç—Ä–æ–ª—å —Å–∏—Å—Ç–µ–º—ã –ø—Ä–∏–≥–æ–¥–Ω–æ—Å—Ç–∏**:
     * –í—Ä–µ–º—è —É–¥–µ—Ä–∂–∏–≤–∞–Ω–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø–∏–∫–∞: 8.5 ¬± 0.2 –º–∏–Ω
     * –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–∞—Ä–µ–ª–æ–∫: ‚â• 5000
     * –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∞—Å–∏–º–º–µ—Ç—Ä–∏–∏: 0.8 - 1.5
     * RSD –ø–ª–æ—â–∞–¥–µ–π –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∏–Ω—ä–µ–∫—Ü–∏–π: ‚â§ 2.0%
   - **–ö—Ä–∏—Ç–µ—Ä–∏–π –ø—Ä–∏–µ–º–∫–∏**: –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –Ω–æ—Ä–º–µ
   - **–ü—Ä–∏ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏**: –ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤ –∏–ª–∏ —Ç–µ—Ö–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

5. **–ê–Ω–∞–ª–∏–∑ —Ç–µ—Å—Ç–æ–≤—ã—Ö –æ–±—Ä–∞–∑—Ü–æ–≤**
   - –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –æ–±—Ä–∞–∑—Ü–æ–≤ —Å–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–æ—Ü–µ–¥—É—Ä–µ –ø—Ä–æ–±–æ–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ ‚úì
   - –ò–Ω—ä–µ–∫—Ü–∏—è –≤ —Ç–æ–º –∂–µ —Ä–µ–∂–∏–º–µ —á—Ç–æ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã ‚úì
   - –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –∏–Ω—ä–µ–∫—Ü–∏–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞ –∫–∞–∂–¥—ã–µ 10 –æ–±—Ä–∞–∑—Ü–æ–≤ ‚úì
   - **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –∞–Ω–∞–ª–∏–∑–∞**:
     * –î–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã: –Ω–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–µ–≤—ã—à–∞—Ç—å –∏—Å—Ö–æ–¥–Ω–æ–µ –±–æ–ª–µ–µ —á–µ–º –Ω–∞ 20%
     * –í—Ä–µ–º—è —É–¥–µ—Ä–∂–∏–≤–∞–Ω–∏—è: –¥—Ä–µ–π—Ñ ‚â§ 2% –æ—Ç –∏—Å—Ö–æ–¥–Ω–æ–≥–æ
     * –§–æ—Ä–º–∞ –ø–∏–∫–∞: –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–∞—Å—â–µ–ø–ª–µ–Ω–∏—è –∏–ª–∏ –¥–µ—Ñ–æ—Ä–º–∞—Ü–∏–∏
   - **–ü—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è—Ö**: –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–Ω–∞–ª–∏–∑–∞, –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

III. –ó–ê–í–ï–†–®–ï–ù–ò–ï –†–ê–ë–û–¢–´
6. **–ü—Ä–æ–º—ã–≤–∫–∞ –∏ –∫–æ–Ω—Å–µ—Ä–≤–∞—Ü–∏—è (15-20 –º–∏–Ω)**
   - –ü—Ä–æ–º—ã–≤–∫–∞ —Ä–∞—Å—Ç–≤–æ—Ä–∏—Ç–µ–ª–µ–º —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–º —Å –∫–æ–ª–æ–Ω–∫–æ–π: 100% –º–µ—Ç–∞–Ω–æ–ª ‚úì
   - –°–∫–æ—Ä–æ—Å—Ç—å –ø–æ—Ç–æ–∫–∞: 0.5 –º–ª/–º–∏–Ω ‚úì
   - –û–±—ä–µ–º –ø—Ä–æ–º—ã–≤–∫–∏: 20 –æ–±—ä–µ–º–æ–≤ –∫–æ–ª–æ–Ω–∫–∏ ‚úì
   - –°–Ω–∏–∂–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–æ—Ç–æ–∫–∞ –¥–æ 0.1 –º–ª/–º–∏–Ω –ø–µ—Ä–µ–¥ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ–º ‚úì
   - **–ö—Ä–∏—Ç–µ—Ä–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è**: –°—Ç–∞–±–∏–ª—å–Ω–∞—è –±–∞–∑–æ–≤–∞—è –ª–∏–Ω–∏—è –≤ —Ä–µ–∂–∏–º–µ –∫–æ–Ω—Å–µ—Ä–≤–∞—Ü–∏–∏
""",
                technical_requirements=[
                    "–í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å —á–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å –¥–æ–ø—É—Å–∫–∞–º–∏",
                    "–ö–∞–∂–¥—ã–π —à–∞–≥ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è",
                    "–£–∫–∞–∑–∞–Ω—ã –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–º–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏",
                    "–û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è—Ö –æ—Ç –Ω–æ—Ä–º—ã"
                ],
                safety_requirements=[
                    "–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ç–æ—á–∫–∞—Ö",
                    "–£–∫–∞–∑–∞–Ω—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –°–ò–ó –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞",
                    "–û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –∞–≤–∞—Ä–∏–π–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏—è—Ö"
                ],
                regulatory_requirements=[
                    "–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ USP <621> –•—Ä–æ–º–∞—Ç–æ–≥—Ä–∞—Ñ–∏—è",
                    "–°–æ–±–ª—é–¥–µ–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ GMP",
                    "–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–º –∑–∞–ø–∏—Å—è–º"
                ],
                quality_criteria=[
                    "–í—Å–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω—ã –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã",
                    "–û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∫—Ä–∏—Ç–µ—Ä–∏–∏ —Å–∏—Å—Ç–µ–º—ã –ø—Ä–∏–≥–æ–¥–Ω–æ—Å—Ç–∏",
                    "–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –∫–æ–Ω—Ç—Ä–æ–ª—è –∫–∞—á–µ—Å—Ç–≤–∞"
                ]
            )
        }
        
        # TROUBLESHOOTING SECTION  
        templates[SectionType.TROUBLESHOOTING] = {
            EquipmentCategory.GENERIC: PromptTemplate(
                section_type=SectionType.TROUBLESHOOTING,
                equipment_category=EquipmentCategory.GENERIC,
                base_prompt="""
–°–æ–∑–¥–∞–π –¥–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª "–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞":

–î–ò–ê–ì–ù–û–°–¢–ò–ß–ï–°–ö–ò–ô –ê–õ–ì–û–†–ò–¢–ú:
1. **–ü–µ—Ä–≤–∏—á–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (2-5 –º–∏–Ω)**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
   - –ê–Ω–∞–ª–∏–∑ —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö
   - –í–∏–∑—É–∞–ª—å–Ω–∞—è –∏–Ω—Å–ø–µ–∫—Ü–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

2. **–°–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É "–æ—Ç –ø—Ä–æ—Å—Ç–æ–≥–æ –∫ —Å–ª–æ–∂–Ω–æ–º—É"
   - –ò–∑–æ–ª—è—Ü–∏—è –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∑–∞–∏–º–æ—Å–≤—è–∑–µ–π –º–µ–∂–¥—É —Å–∏—Å—Ç–µ–º–∞–º–∏

–¢–ò–ü–ò–ß–ù–´–ï –ù–ï–ò–°–ü–†–ê–í–ù–û–°–¢–ò –ò –†–ï–®–ï–ù–ò–Ø:

**–ü–†–û–ë–õ–ï–ú–ê 1: [–ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞]**
üìã **–°–∏–º–ø—Ç–æ–º—ã:**
- –°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –Ω–∞–±–ª—é–¥–∞–µ–º—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø–æ–∫–∞–∑–∞–Ω–∏—è—Ö –ø—Ä–∏–±–æ—Ä–æ–≤
- –ê–Ω–æ–º–∞–ª—å–Ω—ã–µ –∑–≤—É–∫–∏, –∑–∞–ø–∞—Ö–∏, –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥

üîç **–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã (–ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É):**
1. –ù–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞
2. –í—Ç–æ—Ä–∞—è –ø–æ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –ø—Ä–∏—á–∏–Ω–∞  
3. –†–µ–¥–∫–∏–µ, –Ω–æ –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã

‚ö° **–ü–æ—à–∞–≥–æ–≤–æ–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ:**
1. **–ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è** (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å):
   - –î–µ–π—Å—Ç–≤–∏—è –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
   - –ò–∑–æ–ª—è—Ü–∏—è –æ–ø–∞—Å–Ω–æ—Å—Ç–∏
   
2. **–î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:**
   - –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è –∏ —Ç–µ—Å—Ç—ã
   - –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
   - –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∫–∏
   
3. **–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è:**
   - –ü–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é
   - –¢—Ä–µ–±—É–µ–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
   - –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—à–Ω–æ–≥–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è
   
4. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:**
   - –¢–µ—Å—Ç—ã –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è
   - –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏
   - –î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –Ω–µ—É—Å–ø–µ—à–Ω–æ–º —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–∏

üéØ **–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—à–Ω–æ–≥–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è:**
- –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∏–∑–º–µ—Ä–∏–º—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
- –í–æ–∑–≤—Ä–∞—Ç –∫ –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã

‚ö†Ô∏è **–ö–æ–≥–¥–∞ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—É:**
- –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ (X –º–∏–Ω—É—Ç)
- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è
- –ü—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

–ü–†–ï–í–ï–ù–¢–ò–í–ù–´–ï –ú–ï–†–´:
- –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Ä–∞–Ω–Ω–µ–≥–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ç–µ—Ö–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—é

–î–û–ö–£–ú–ï–ù–¢–ò–†–û–í–ê–ù–ò–ï:
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –æ –Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç—è—Ö
- –í—Ä–µ–º—è –ø—Ä–æ—Å—Ç–æ—è –∏ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø—Ä–∏–Ω—è—Ç—ã—Ö –º–µ—Ä
""",
                technical_requirements=[
                    "–°–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏",
                    "–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è –∏ –∫—Ä–∏—Ç–µ—Ä–∏–∏",
                    "–ß–µ—Ç–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π",
                    "–°–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã"
                ],
                safety_requirements=[
                    "–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ",
                    "–ü—Ä–æ—Ü–µ–¥—É—Ä—ã –∏–∑–æ–ª—è—Ü–∏–∏ –æ–ø–∞—Å–Ω–æ—Å—Ç–µ–π", 
                    "–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –°–ò–ó –ø—Ä–∏ —Ä–µ–º–æ–Ω—Ç–µ"
                ],
                regulatory_requirements=[
                    "–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π",
                    "–ü—Ä–æ—Ü–µ–¥—É—Ä—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è",
                    "–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞"
                ],
                quality_criteria=[
                    "–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä–µ—à–µ–Ω–∏–π –∏–∑–º–µ—Ä–∏–º–∞",
                    "–ü—Ä–æ—Å–ª–µ–∂–∏–≤–∞–µ–º–æ—Å—Ç—å –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π",
                    "–ê–Ω–∞–ª–∏–∑ –∫–æ—Ä–Ω–µ–≤—ã—Ö –ø—Ä–∏—á–∏–Ω"
                ]
            )
        }
        
        return templates
    
    def _initialize_context_enhancers(self) -> Dict[str, Any]:
        """Initialize context enhancement patterns"""
        return {
            "technical_detail_enhancers": {
                "parameters": [
                    "–£–∫–∞–∂–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —á–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å –µ–¥–∏–Ω–∏—Ü–∞–º–∏ –∏–∑–º–µ—Ä–µ–Ω–∏—è",
                    "–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –¥–æ–ø—É—Å—Ç–∏–º—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã –∏ –¥–æ–ø—É—Å–∫–∏",
                    "–í–∫–ª—é—á–∏—Ç–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞",
                    "–£–∫–∞–∂–∏—Ç–µ –º–µ—Ç–æ–¥—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è –∏ –∫–æ–Ω—Ç—Ä–æ–ª—è"
                ],
                "procedures": [
                    "–†–∞–∑–±–µ–π—Ç–µ –Ω–∞ —á–µ—Ç–∫–∏–µ –ø—Ä–æ–Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–µ —à–∞–≥–∏",
                    "–£–∫–∞–∂–∏—Ç–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞",
                    "–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è",
                    "–í–∫–ª—é—á–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è—Ö"
                ],
                "specifications": [
                    "–£–∫–∞–∂–∏—Ç–µ –º–æ–¥–µ–ª–∏ –∏ —Å–µ—Ä–∏–π–Ω—ã–µ –Ω–æ–º–µ—Ä–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è",
                    "–í–∫–ª—é—á–∏—Ç–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏",
                    "–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–∞–ª–∏–±—Ä–æ–≤–∫–µ",
                    "–£–∫–∞–∂–∏—Ç–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ç–µ—Ö–æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—é"
                ]
            },
            "safety_enhancers": [
                "–ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤ –ø—Ä–æ—Ü–µ–¥—É—Ä–Ω—ã–µ —à–∞–≥–∏",
                "–£–∫–∞–∂–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –°–ò–ó –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ –æ–ø–µ—Ä–∞—Ü–∏–π",
                "–í–∫–ª—é—á–∏—Ç–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –õ–û–¢–û –≥–¥–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ", 
                "–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –∞–≤–∞—Ä–∏–π–Ω—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã"
            ],
            "regulatory_enhancers": [
                "–£–∫–∞–∂–∏—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –Ω–æ–º–µ—Ä–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–≤ –∏ —Ä–∞–∑–¥–µ–ª–æ–≤",
                "–í–∫–ª—é—á–∏—Ç–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—é",
                "–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏",
                "–£–∫–∞–∂–∏—Ç–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –æ–±—É—á–µ–Ω–∏—é –ø–µ—Ä—Å–æ–Ω–∞–ª–∞"
            ]
        }
    
    def _initialize_validation_criteria(self) -> Dict[str, List[str]]:
        """Initialize validation criteria for generated content"""
        return {
            "technical_completeness": [
                "–í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–º–µ—é—Ç —á–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è",
                "–£–∫–∞–∑–∞–Ω—ã –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è",
                "–û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∫—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏",
                "–í–∫–ª—é—á–µ–Ω—ã –ø—Ä–æ—Ü–µ–¥—É—Ä—ã –∫–æ–Ω—Ç—Ä–æ–ª—è"
            ],
            "safety_integration": [
                "–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã", 
                "–£–∫–∞–∑–∞–Ω—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –°–ò–ó",
                "–û–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∞–≤–∞—Ä–∏–π–Ω—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã",
                "–í–∫–ª—é—á–µ–Ω—ã —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"
            ],
            "regulatory_compliance": [
                "–°—Å—ã–ª–∫–∏ –Ω–∞ –ø—Ä–∏–º–µ–Ω–∏–º—ã–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã",
                "–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—é",
                "–ü—Ä–æ—Ü–µ–¥—É—Ä—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏",
                "–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–≤–∞–ª–∏—Ñ–∏–∫–∞—Ü–∏–∏"
            ],
            "operational_readiness": [
                "–ü—Ä–æ—Ü–µ–¥—É—Ä—ã –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é",
                "–ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã",
                "–î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è—Ö —É–∫–∞–∑–∞–Ω—ã",
                "–í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä–∞–º–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã"
            ]
        }
    
    def generate_advanced_prompt(self, 
                                section_type: SectionType,
                                equipment_category: EquipmentCategory = EquipmentCategory.GENERIC,
                                custom_requirements: List[str] = None,
                                reference_context: str = None,
                                previous_content: str = None) -> str:
        """Generate advanced, context-aware prompt for specific section"""
        
        # Get base template
        if section_type in self.prompt_templates:
            if equipment_category in self.prompt_templates[section_type]:
                template = self.prompt_templates[section_type][equipment_category]
            else:
                # Fallback to generic if specific equipment category not found
                template = self.prompt_templates[section_type].get(
                    EquipmentCategory.GENERIC,
                    self.prompt_templates[section_type][list(self.prompt_templates[section_type].keys())[0]]
                )
        else:
            # Create minimal template if section type not found
            template = PromptTemplate(
                section_type=section_type,
                equipment_category=equipment_category,
                base_prompt=f"–°–æ–∑–¥–∞–π –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª '{section_type.value}' —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π.",
                technical_requirements=["–í–∫–ª—é—á–∏—Ç–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏"],
                safety_requirements=["–í–∫–ª—é—á–∏—Ç–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏"],
                regulatory_requirements=["–í–∫–ª—é—á–∏—Ç–µ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è"],
                quality_criteria=["–û–±–µ—Å–ø–µ—á—å—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è"]
            )
        
        # Build enhanced prompt
        prompt_parts = []
        
        # Base prompt
        prompt_parts.append(template.base_prompt)
        
        # Context integration
        if reference_context:
            prompt_parts.append(f"\n**–ö–û–ù–¢–ï–ö–°–¢ –ò–ó –°–ü–†–ê–í–û–ß–ù–´–• –î–û–ö–£–ú–ï–ù–¢–û–í:**\n{reference_context[:1000]}...")
        
        if previous_content:
            prompt_parts.append(f"\n**–°–í–Ø–ó–¨ –° –ü–†–ï–î–´–î–£–©–ò–ú–ò –†–ê–ó–î–ï–õ–ê–ú–ò:**\n–û–±–µ—Å–ø–µ—á—å—Ç–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å —Å: {previous_content[:500]}...")
        
        # Technical requirements
        prompt_parts.append("\n**–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–´–ï –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø:**")
        for req in template.technical_requirements:
            prompt_parts.append(f"‚úì {req}")
        
        # Safety requirements
        prompt_parts.append("\n**–¢–†–ï–ë–û–í–ê–ù–ò–Ø –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò:**")
        for req in template.safety_requirements:
            prompt_parts.append(f"üõ°Ô∏è {req}")
        
        # Regulatory requirements
        prompt_parts.append("\n**–ù–û–†–ú–ê–¢–ò–í–ù–´–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø:**")
        for req in template.regulatory_requirements:
            prompt_parts.append(f"üìã {req}")
        
        # Quality criteria
        prompt_parts.append("\n**–ö–†–ò–¢–ï–†–ò–ò –ö–ê–ß–ï–°–¢–í–ê:**")
        for criteria in template.quality_criteria:
            prompt_parts.append(f"üéØ {criteria}")
        
        # Custom requirements
        if custom_requirements:
            prompt_parts.append("\n**–î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø:**")
            for req in custom_requirements:
                prompt_parts.append(f"‚≠ê {req}")
        
        # Professional standards
        prompt_parts.append("\n**–ü–†–û–§–ï–°–°–ò–û–ù–ê–õ–¨–ù–´–ï –°–¢–ê–ù–î–ê–†–¢–´:**")
        prompt_parts.append("‚Ä¢ –î–æ–∫—É–º–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≥–æ—Ç–æ–≤ –∫ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–º—É –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é")
        prompt_parts.append("‚Ä¢ –í—Å–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –∏ –∏–∑–º–µ—Ä–∏–º—ã–º–∏")
        prompt_parts.append("‚Ä¢ –û–±–µ—Å–ø–µ—á—å—Ç–µ –ø–æ–ª–Ω—É—é –ø—Ä–æ—Å–ª–µ–∂–∏–≤–∞–µ–º–æ—Å—Ç—å –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å")
        prompt_parts.append("‚Ä¢ –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ –∫–∞–∂–¥—ã–π —ç—Ç–∞–ø –ø—Ä–æ—Ü–µ–¥—É—Ä—ã")
        
        # Output formatting requirements
        prompt_parts.append("\n**–¢–†–ï–ë–û–í–ê–ù–ò–Ø –ö –§–û–†–ú–ê–¢–£:**")
        prompt_parts.append("‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —á–µ—Ç–∫—É—é –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Å –Ω—É–º–µ—Ä–∞—Ü–∏–µ–π")
        prompt_parts.append("‚Ä¢ –°–æ–∑–¥–∞–≤–∞–π—Ç–µ —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤")
        prompt_parts.append("‚Ä¢ –í—ã–¥–µ–ª—è–π—Ç–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è **–í–ù–ò–ú–ê–ù–ò–ï** –∏ **–ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï**")
        prompt_parts.append("‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —á–µ–∫–±–æ–∫—Å—ã ‚òê –¥–ª—è –ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã—Ö –ª–∏—Å—Ç–æ–≤")
        prompt_parts.append("‚Ä¢ –í–∫–ª—é—á–∞–π—Ç–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã")
        
        return "\n".join(prompt_parts)
    
    def generate_section_specific_prompts(self, 
                                        equipment_type: str,
                                        section_configs: List[Dict[str, Any]],
                                        reference_context: Optional[str] = None) -> List[Dict[str, str]]:
        """Generate section-specific prompts for entire SOP structure"""
        
        # Map equipment type to category
        equipment_category = self._map_equipment_type(equipment_type)
        
        enhanced_prompts = []
        previous_content_summary = ""
        
        for i, section_config in enumerate(section_configs):
            section_title = section_config.get("title", "")
            section_mode = section_config.get("mode", "ai")
            custom_prompt = section_config.get("prompt", "")
            
            # Skip manual sections
            if section_mode == "manual":
                enhanced_prompts.append({
                    "title": section_title,
                    "prompt": "Manual content - no AI generation needed",
                    "mode": "manual"
                })
                continue
            
            # Determine section type
            section_type = self._map_section_title_to_type(section_title)
            
            # Build custom requirements from user prompt
            custom_requirements = []
            if custom_prompt:
                custom_requirements.append(custom_prompt)
            
            # Generate advanced prompt
            advanced_prompt = self.generate_advanced_prompt(
                section_type=section_type,
                equipment_category=equipment_category,
                custom_requirements=custom_requirements,
                reference_context=reference_context,
                previous_content=previous_content_summary if i > 0 else None
            )
            
            enhanced_prompts.append({
                "title": section_title,
                "prompt": advanced_prompt,
                "mode": section_mode,
                "section_type": section_type.value,
                "equipment_category": equipment_category.value
            })
            
            # Update previous content summary for context continuity
            previous_content_summary += f" {section_title};"
        
        return enhanced_prompts
    
    def _map_equipment_type(self, equipment_type: str) -> EquipmentCategory:
        """Map equipment type string to category enum"""
        equipment_type_lower = equipment_type.lower()
        
        if any(keyword in equipment_type_lower for keyword in ['—Ö—Ä–æ–º–∞—Ç–æ–≥—Ä–∞—Ñ', 'chromatograph', 'hplc', 'gc', 'lc-ms']):
            return EquipmentCategory.CHROMATOGRAPHY
        elif any(keyword in equipment_type_lower for keyword in ['—Å–ø–µ–∫—Ç—Ä–æ–º–µ—Ç—Ä', 'spectrometer', '—Å–ø–µ–∫—Ç—Ä–æ—Ñ–æ—Ç–æ–º–µ—Ç—Ä']):
            return EquipmentCategory.SPECTROSCOPY
        elif any(keyword in equipment_type_lower for keyword in ['–º–∏–∫—Ä–æ—Å–∫–æ–ø', 'microscope']):
            return EquipmentCategory.MICROSCOPY
        elif any(keyword in equipment_type_lower for keyword in ['–≤–µ—Å—ã', 'balance']):
            return EquipmentCategory.ANALYTICAL_BALANCE
        elif any(keyword in equipment_type_lower for keyword in ['—Ü–µ–Ω—Ç—Ä–∏—Ñ—É–≥', 'centrifuge']):
            return EquipmentCategory.CENTRIFUGE
        elif any(keyword in equipment_type_lower for keyword in ['—Ç–µ—Ä–º–æ–∞–Ω–∞–ª–∏–∑', 'thermal', 'dsc', 'tga']):
            return EquipmentCategory.THERMAL_ANALYZER
        else:
            return EquipmentCategory.GENERIC
    
    def _map_section_title_to_type(self, title: str) -> SectionType:
        """Map section title to section type enum"""
        title_lower = title.lower()
        
        if any(keyword in title_lower for keyword in ['—Ü–µ–ª—å', '–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ', '–æ–±–ª–∞—Å—Ç—å', '–ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ', 'purpose', 'scope']):
            return SectionType.PURPOSE_SCOPE
        elif any(keyword in title_lower for keyword in ['–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å', '–ø–µ—Ä—Å–æ–Ω–∞–ª', '–æ–±—É—á–µ–Ω–∏–µ', 'responsibility']):
            return SectionType.RESPONSIBILITY
        elif any(keyword in title_lower for keyword in ['–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å', '—Ä–∏—Å–∫', '–æ–ø–∞—Å–Ω–æ—Å—Ç—å', 'safety', 'risk']):
            return SectionType.SAFETY_RISK
        elif any(keyword in title_lower for keyword in ['–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ', '–º–∞—Ç–µ—Ä–∏–∞–ª—ã', '—Å—Ä–µ–¥—Å—Ç–≤–∞', 'equipment', 'materials']):
            return SectionType.EQUIPMENT_MATERIALS
        elif any(keyword in title_lower for keyword in ['–ø—Ä–æ—Ü–µ–¥—É—Ä–∞', '–º–µ—Ç–æ–¥–∏–∫–∞', '–ø–æ—Ä—è–¥–æ–∫', 'procedure', 'method']):
            return SectionType.PROCEDURES
        elif any(keyword in title_lower for keyword in ['–∫–∞—á–µ—Å—Ç–≤–æ', '–∫–æ–Ω—Ç—Ä–æ–ª—å', 'quality', 'control']):
            return SectionType.QUALITY_CONTROL
        elif any(keyword in title_lower for keyword in ['–¥–æ–∫—É–º–µ–Ω—Ç', '–∑–∞–ø–∏—Å—å', 'documentation', 'records']):
            return SectionType.DOCUMENTATION
        elif any(keyword in title_lower for keyword in ['—Å—Å—ã–ª–∫–∏', '—Å—Ç–∞–Ω–¥–∞—Ä—Ç', '–Ω–æ—Ä–º–∞—Ç–∏–≤', 'references', 'standards']):
            return SectionType.REFERENCES
        elif any(keyword in title_lower for keyword in ['–Ω–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç—å', '–ø—Ä–æ–±–ª–µ–º–∞', '–¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞', 'troubleshooting']):
            return SectionType.TROUBLESHOOTING
        else:
            return SectionType.PROCEDURES  # Default to procedures
    
    def validate_generated_content(self, content: str, section_type: SectionType) -> Dict[str, Any]:
        """Validate generated content against professional criteria"""
        
        validation_results = {
            "overall_score": 0,
            "technical_completeness": 0,
            "safety_integration": 0, 
            "regulatory_compliance": 0,
            "operational_readiness": 0,
            "issues": [],
            "recommendations": []
        }
        
        # Get validation criteria for section type
        if section_type.value in self.validation_criteria:
            criteria = self.validation_criteria[section_type.value]
        else:
            # Use general criteria
            criteria = self.validation_criteria["operational_readiness"]
        
        # Technical completeness check
        tech_score = 0
        if re.search(r'\d+(?:\.\d+)?\s*[a-zA-Z–∞-—è–ê-–Ø%‚ÑÉ¬∞]', content):  # Numbers with units
            tech_score += 25
        if re.search(r'–∫—Ä–∏—Ç–µ—Ä–∏[–π—è]|–ø—Ä–∏–µ–º–∫[–∞–∏]|–¥–æ–ø—É—Å–∫', content, re.IGNORECASE):  # Acceptance criteria
            tech_score += 25
        if re.search(r'–¥–∏–∞–ø–∞–∑–æ–Ω|–ø—Ä–µ–¥–µ–ª|–æ—Ç\s+\d+\s+–¥–æ\s+\d+', content, re.IGNORECASE):  # Ranges
            tech_score += 25
        if re.search(r'–∫–æ–Ω—Ç—Ä–æ–ª—å|–∏–∑–º–µ—Ä–µ–Ω–∏|–ø—Ä–æ–≤–µ—Ä–∫', content, re.IGNORECASE):  # Control procedures
            tech_score += 25
        
        validation_results["technical_completeness"] = tech_score
        
        # Safety integration check
        safety_score = 0
        if re.search(r'\*\*(?:–í–ù–ò–ú–ê–ù–ò–ï|–ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï)\*\*', content):  # Safety warnings
            safety_score += 30
        if re.search(r'—Å–∏–∑|–∑–∞—â–∏—Ç–Ω.*—Å—Ä–µ–¥—Å—Ç–≤|–ø–µ—Ä—á–∞—Ç–∫|–æ—á–∫', content, re.IGNORECASE):  # PPE
            safety_score += 30
        if re.search(r'–∞–≤–∞—Ä–∏–π–Ω|—ç–∫—Å—Ç—Ä–µ–Ω–Ω|—á—Ä–µ–∑–≤—ã—á–∞–π–Ω', content, re.IGNORECASE):  # Emergency procedures
            safety_score += 20
        if re.search(r'–≥–æ—Å—Ç|—Å–∞–Ω–ø–∏–Ω|iso|osha', content, re.IGNORECASE):  # Safety standards
            safety_score += 20
        
        validation_results["safety_integration"] = safety_score
        
        # Regulatory compliance check
        reg_score = 0
        if re.search(r'(?:–ì–û–°–¢|ISO|OSHA|USP|ICH)\s+[\d.-]+', content):  # Standard references
            reg_score += 40
        if re.search(r'–¥–æ–∫—É–º–µ–Ω—Ç.*—Ç—Ä–µ–±–æ–≤–∞–Ω–∏|–∑–∞–ø–∏—Å.*–≤–µ–¥–µ–Ω–∏', content, re.IGNORECASE):  # Documentation
            reg_score += 30
        if re.search(r'–≤–∞–ª–∏–¥–∞—Ü–∏|–ø–æ–≤–µ—Ä–∫|–∫–∞–ª–∏–±—Ä–æ–≤–∫', content, re.IGNORECASE):  # Validation
            reg_score += 30
        
        validation_results["regulatory_compliance"] = reg_score
        
        # Operational readiness check
        op_score = 0
        if re.search(r'^\d+\.\s+', content, re.MULTILINE):  # Numbered steps
            op_score += 25
        if re.search(r'–≤—Ä–µ–º—è.*–º–∏–Ω|–ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç', content, re.IGNORECASE):  # Time requirements
            op_score += 25
        if re.search(r'–ø—Ä–∏\s+(?:–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏|–Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏|–ø—Ä–µ–≤—ã—à–µ–Ω–∏)', content, re.IGNORECASE):  # Exception handling
            op_score += 25
        if len(content) > 500:  # Sufficient detail
            op_score += 25
        
        validation_results["operational_readiness"] = op_score
        
        # Calculate overall score
        validation_results["overall_score"] = int((tech_score + safety_score + reg_score + op_score) / 4)
        
        # Generate recommendations
        if tech_score < 75:
            validation_results["recommendations"].append("–î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –¥–µ—Ç–∞–ª–µ–π —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏")
        if safety_score < 75:
            validation_results["recommendations"].append("–£—Å–∏–ª–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –º–µ—Ä –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏")
        if reg_score < 75:
            validation_results["recommendations"].append("–î–æ–±–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫–∏ –Ω–∞ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã")
        if op_score < 75:
            validation_results["recommendations"].append("–£–ª—É—á—à–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—É—é –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –ø—Ä–æ—Ü–µ–¥—É—Ä")
        
        return validation_results
    
    def get_equipment_specific_enhancements(self, equipment_category: EquipmentCategory) -> Dict[str, Any]:
        """Get equipment-specific enhancements and templates"""
        
        enhancements = {
            "common_parameters": [],
            "typical_procedures": [],
            "safety_considerations": [],
            "regulatory_standards": [],
            "troubleshooting_patterns": []
        }
        
        if equipment_category == EquipmentCategory.CHROMATOGRAPHY:
            enhancements.update({
                "common_parameters": [
                    "–°–∫–æ—Ä–æ—Å—Ç—å –ø–æ—Ç–æ–∫–∞ (–º–ª/–º–∏–Ω)", "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∫–æ–ª–æ–Ω–∫–∏ (¬∞C)",
                    "–î–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã (–±–∞—Ä)", "–û–±—ä–µ–º –∏–Ω—ä–µ–∫—Ü–∏–∏ (–º–∫–ª)",
                    "–í—Ä–µ–º—è —É–¥–µ—Ä–∂–∏–≤–∞–Ω–∏—è (–º–∏–Ω)", "–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ø–∏–∫–æ–≤"
                ],
                "typical_procedures": [
                    "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–æ–±–∏–ª—å–Ω–æ–π —Ñ–∞–∑—ã", "–£—Ä–∞–≤–Ω–æ–≤–µ—à–∏–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã",
                    "–°–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–≥–æ–¥–Ω–æ—Å—Ç–∏", "–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–Ω–∞–ª–∏–∑–∞",
                    "–ü—Ä–æ–º—ã–≤–∫–∞ –∏ –∫–æ–Ω—Å–µ—Ä–≤–∞—Ü–∏—è"
                ],
                "safety_considerations": [
                    "–¢–æ–∫—Å–∏—á–Ω—ã–µ —Ä–∞—Å—Ç–≤–æ—Ä–∏—Ç–µ–ª–∏", "–í—ã—Å–æ–∫–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ",
                    "–ö–∏—Å–ª–æ—Ç–Ω—ã–µ –±—É—Ñ–µ—Ä—ã", "–£—Ç–∏–ª–∏–∑–∞—Ü–∏—è –æ—Ç—Ö–æ–¥–æ–≤"
                ],
                "regulatory_standards": [
                    "USP <621> Chromatography", "ICH Q2(R1)",
                    "–ì–û–°–¢ 31640-2012", "ISO 17025:2017"
                ]
            })
        elif equipment_category == EquipmentCategory.SPECTROSCOPY:
            enhancements.update({
                "common_parameters": [
                    "–î–ª–∏–Ω–∞ –≤–æ–ª–Ω—ã (–Ω–º)", "–°–ø–µ–∫—Ç—Ä–∞–ª—å–Ω–∞—è —à–∏—Ä–∏–Ω–∞ —â–µ–ª–∏ (–Ω–º)",
                    "–ê–±—Å–æ—Ä–±—Ü–∏—è (A)", "–ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å –∏–∑–ª—É—á–µ–Ω–∏—è",
                    "–í—Ä–µ–º—è –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∏—è (—Å)"
                ],
                "typical_procedures": [
                    "–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã –≤–æ–ª–Ω—ã", "–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –∞–±—Å–æ—Ä–±—Ü–∏–∏",
                    "–ö–æ–Ω—Ç—Ä–æ–ª—å —Å—Ç—Ä–µ–π-—Å–≤–µ—Ç–∞", "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–±—Ä–∞–∑—Ü–æ–≤"
                ],
                "safety_considerations": [
                    "–£–§ –∏–∑–ª—É—á–µ–Ω–∏–µ", "–ö–≤–∞—Ä—Ü–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã",
                    "–¢–æ–∫—Å–∏—á–Ω—ã–µ —Ä–∞—Å—Ç–≤–æ—Ä–∏—Ç–µ–ª–∏", "–í—ã—Å–æ–∫–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ª–∞–º–ø"
                ]
            })
        
        return enhancements